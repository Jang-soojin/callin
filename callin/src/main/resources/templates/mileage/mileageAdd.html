<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
	  
<th:block layout:fragment="customTitle">
	<title th:text="${title}"></title>
</th:block>
<head th:replace="fragments/head :: headFragment"></head>
	<!-- daterange picker -->
	<link rel="stylesheet" th:href="@{/AdminLTE-master/plugins/daterangepicker/daterangepicker.css}">
	<body class="hold-transition sidebar-mini layout-fixed">
		<div id="wrapper">
			<!-- begin topNav -->
			<div th:replace="fragments/topNav :: topNavFragment"></div>
			<!-- end topNav -->
			
			<!-- Main Sidebar Container -->
			<div th:replace="fragments/sideBar :: sideBarFragment01"></div>
			<th:block layout:fragment="mileageAdd"> 
				<!-- Content Wrapper. Contains page content -->
			<div class="content-wrapper">
			<!-- Content Header (Page header) -->
				<section class="content-header">
					<div class="container-fluid">
						
					</div><!-- /.container-fluid -->
				</section>
			
			    <!-- Main content -->
				<section class="content">
					<div class="container-fluid">
						<form id="chooseMileage" name="chooseMileage" th:action="@{/admin/mileage/mileageAdd}" method="post"> 
							<section class="content">
								<div class="card card-info">
									<table class="table table-bordered">
										<colgroup>
											<col style="width:13%" />
											<col style="width:50%" />
											<col style="width:5%" />
											<col style="width:32%" />
										</colgroup>
										<tbody>
											<tr>
												<th width="180" style="line-height: 428px;"> 학생  선택</th>
												<td style="border-right:0;">
													<table border="0" class="table">
														<tbody>
															<tr>
																<td>
																	<div style="margin:auto;border:1px solid #cecece;background-color:#ebebeb">
																		<div class="BtnTBlack20" style="margin:0px 0 5px 5px;padding:5px 0 5px 0;">
																			<select id="schMemGrade" name="schMemGrade" class="NSelect25">
																				<option value="">전체 등급</option>
																				<option value="T">등급 없음</option>
																				<option value="SG_33376">1등급</option>
																				<option value="SG_32207">2등급</option>
																			</select>
																			<select name="schGubun" class="NSelect25" onkeypress="if(event.keyCode==13) sch_Go();">
																				<option value="">검색 항목</option>
																				<option value="schGubun_ID">아이디</option>
																				<option value="schGubun_Name" selected="selected">이름</option>
																			</select>
																			
																			<input type="text" id="schText" value="" class="ml_2" style="width:140px;" onkeypress="if(event.keyCode==13) sch_Go();">
																			<button class="btn btn-secondary" type="button" onclick="javascript:fnSearch(); return false;"><span>검색</span></button>
																		</div>
																	</div>
																	
																	<div style="height:350px;margin:20px auto;border:0px solid #cecece;">
																		<ul style="padding:0; list-style:none;">
																			<li>
																				<div class="scroll_div_pop" width="100%">
																					<table class="search_student_table" style="width:100%;margin:auto">
																						<colgroup>
																							<col style="width:10%" />
																							<col style="width:30%" />
																							<col style="width:*" />
																							<col style="width:20%" />
																						</colgroup>
																						<thead>
																							<tr>
																								<th scope="row">
																									<input type="checkbox" name="allChk" id="allChk" />
																								</th>
																								<th scope="row">이름</th>
																								<th scope="row">아이디</th>
																								<th scope="row">선택</th>
																							</tr>
																						</thead>
																						<tbody>
																							<tr onmouseover="this.style.backgroundColor=&quot;#F2F6FF&quot;" onmouseout="this.style.backgroundColor=&quot;&quot;" style="">
																								<td>
																									<input type="hidden" id="s_MemSKU" name="s_MemSKU" value="ST_IT73931" />
																									<input value="아이티맵[itmap]|ST_IT73931@@" type="checkbox" name="LCheck_List" />
																								</td>
																								<td>아이티맵</td>
																								<td>itmap</td>
																								<td class="align_c">
																									<div class="BtnGray15 align_c">
																										<button type="button" class="btn btn-secondary" onclick="gorSelect('아이티맵[itmap]|ST_IT73931@@')" title="선택"><span>선택</span></button>
																									</div>
																								</td>
																							</tr>
																						</tbody>
																					</table>
																				</div>
																				<div style="margin:10px auto"></div>
																			</li>
																		</ul>
																	</div>
																</td>
															</tr>
														</tbody>
													</table>
												</td>
												<td style="border-left:0; border-right:0;vertical-align:middle;text-align:center;">
													<div class="BtnTBlack20 float_l ml_20">
														<button type="button" class="btn btn-secondary" onclick="javascript:gorallSelect(); return false;"><span style="font-size:15px;font-weight:bold;padding:5px 0 5px 0">▶</span> </button>
													</div>
												</td>
												<td style="border-left:0;">
													<div>
														<div class="form-group">
															<div style="margin:auto;border:1px solid #cecece;background-color:#ebebeb">
																<label style="line-height:2.5; margin-right:5px;">● 학생목록</label>
																<button type="button" class="btn btn-secondary" onclick="javascript:fnReset(); return false;"><span>초기화</span></button>
															</div>
															
															<select id="moveSlct" name="moveSlct" class="select2bs4" multiple="multiple" data-placeholder="Select a State" style="width: 100%;height:402px;">
															</select>
														</div>
													</div>
												</td>
											</tr>	
											<tr>							
												<th width="180"> 적립금 유형</th>
												<td width="*.*" colspan="3">관리자 직접등록</td>
											</tr>						
											<tr>
												<th> 적립 시점</th>
												<td>
													<select id="p_PointStepCode" name="p_PointStepCode" class="NSelect25">
														<option value="200">즉시 적립</option>
														<option value="100">적립 대기</option>									
													</select>
												</td>
											</tr>						
											<tr>							
												<th> 적립/차감</th>
												<td colspan="3">
													<select id="p_PointType" name="p_PointType" class="NSelect25">
														<option value="A">적립(+)</option>
														<option value="S">차감(-)</option>
													</select>
												</td>
											</tr>
											<tr>							
												<th> 적립금</th>
												<td colspan="3">
													<input type="text" id="p_AccPoint" name="p_AccPoint" value="" class="amount" onkeyup="toCurrency(this)" onblur="toCurrency(this)" style="width:80px;">[P]							
												</td>
											</tr>						
											<tr>							
												<th> 메모</th>
												<td colspan="3">
													<input type="text" id="p_Memo" name="p_Memo" value="" style="width:600px">
												</td>
											</tr>					
										</tbody>
									</table>
									<div style="text-align:center; margin-bottom:10px;">
										<button type="button" class="btn btn-secondary" id="saveBtn">저장</button>
									</div>
								</div><!-- /.container-fluid -->
							</section>
						</form>
						<!--/.col (right) --> 
					</div>
				</section>
				<!-- /.row -->
			</div><!-- /.container-fluid -->
			<!-- /.content -->
		</th:block>
		
		<div th:replace="fragments/footer :: footerFragment"></div>
		</div>
		<!-- jQuery -->
		<script th:src="@{/AdminLTE-master/plugins/jquery/jquery.min.js}"></script>
		<!-- jQuery UI 1.11.4 -->
		<script th:src="@{/AdminLTE-master/plugins/jquery-ui/jquery-ui.min.js}"></script>
		<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
		<script>
		  $.widget.bridge('uibutton', $.ui.button)
		</script>
		<!-- Bootstrap 4 -->
		<script th:src="@{/AdminLTE-master/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
		<!-- ChartJS -->
		<script th:src="@{/AdminLTE-master/plugins/chart.js/Chart.min.js}"></script>
		<!-- Sparkline -->
		<script th:src="@{/AdminLTE-master/plugins/sparklines/sparkline.js}"></script>
		<!-- daterangepicker -->
		<script th:src="@{/AdminLTE-master/plugins/moment/moment.min.js}"></script>
		<script th:src="@{/AdminLTE-master/plugins/daterangepicker/daterangepicker.js}"></script>
		<!-- date-range-picker -->
		<script th:src="@{/AdminLTE-master/plugins/daterangepicker/daterangepicker.js}"></script>
		<!-- Tempusdominus Bootstrap 4 -->
		<script th:src="@{/AdminLTE-master/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js}"></script>
		<!-- Summernote -->
		<script th:src="@{/AdminLTE-master/plugins/summernote/summernote-bs4.min.js}"></script>
		<!-- overlayScrollbars -->
		<script th:src="@{/AdminLTE-master/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js}"></script>
		<!-- AdminLTE App -->
		<script th:src="@{/AdminLTE-master/dist/js/adminlte.js}"></script>
		<!-- AdminLTE for demo purposes -->

		<script>
			$(function () {
		    //Date range picker
		    $('#reservation').daterangepicker()})
		</script>
		
		
		<script type="text/javascript">
			$(document).ready(function(){
				// 전체 선택
				$("#allChk").on("click", function(){
					$("input[name=LCheck_List]").prop("checked", $(this).is(":checked"));
				});
				
				// 저장
				$("#saveBtn").on("click", function(){
					var frm = document.chooseMileage;
					
					//window.open("urldfk.fdo", "popupname");
					
					frm.action = "mileageSave";
					frm.target = "_self";
					frm.method = "POST";
					frm.submit();
				});
			});
			
			
			// 선택 시 옮기기
			function gorallSelect(){
				var sHtml = "";
				var chkVal = "";
				
				$("input[name=LCheck_List]:checked").each(function(){
					chkVal = $(this).val();
					
					if($("#moveSlct option").filter(function(){ return this.value == chkVal; }).length == 0){
						sHtml += "<option value='" + $(this).val() + "'>" + $(this).closest("td").next().text() + "[" + $(this).closest("td").next().next().text() + "]" + "</option>";
					}
				});
				
				$("#moveSlct").append(sHtml);
			}
		 	$(document).on("click", function gorSelect(){
				var sHtml = "";
				var chkVal = "";
				
					
				
					
					if($("#moveSlct option").filter(function(){ return this.value == chkVal; }).length == 0){
						sHtml += "<option value='" + $(this).val() + "'>" + $(this).closest("td").next().text() + "[" + $(this).closest("td").next().next().text() + "]" + "</option>";
					}
				
				$("#moveSlct").append(sHtml);
			}); 
			
			// 초기화
			function fnReset(){
				$("#moveSlct").html("");
			}
			
			// 검색
			function fnSearch(){
				$.ajax({
					url : "mileageSearch"
					, dataType : "json"
					, type : "post"
					, async : false
					, success : function(reText, stText, xhr){
						var sHtml = "";
						
						$(".search_student_table tbody").html("");
						
						for(var i = 0; i < reText.resultList.length; i++){
							sHtml += "<tr>";
							sHtml += "<td><input type='checkbox' name='LCheck_List' value='" + reText.resultList[i].value + "' /></td>";
							sHtml += "<td>" + reText.resultList[i].name + "</td>";
							sHtml += "<td>" + reText.resultList[i].id + "</td>";
							sHtml += "<td><button type='button' class='btn btn-secondary' onclick='gorSelect(\'아이티맵[itmap]|ST_IT73931@@\')' title='선택'><span>선택</span></button></td>";
							sHtml += "</tr>";
						}
						
						$(".search_student_table tbody").append(sHtml);
					}
					, error : function(){
						alert("조회 중 오류가 발생하였습니다.");
						return false;
					}
				});
			}
		</script>
		

		
</body>
</html>